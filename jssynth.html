<!DOCTYPE html>
<html lang="en" ng-app="js120">
<head>
  <title>JS-120</title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0 user-scalable=no">
  <link rel="stylesheet" type="text/css" media="all" href="jssynth.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
  <script src="lib/AudioContextMonkeyPatch.js"></script>
  <script src="src/app.js"></script>
  <script src="src/services.js"></script>
  <script src="src/jssynth.js"></script>
  <script src="src/analytics.js"></script>
</head>
<body>
<div id="header" class="flex flex-align-center mb1 full-width" ng-controller="TransportController">
  <div id="logo-container">
    <h1 class="logo h2 mt0 mb0" style="line-height: 1.0em;">JS-120</h1>
    <span class="lightText">Web Synthesizer</span>
  </div>
  <div id="transport" class="flex flex-uniform-size flex-align-center">
    <button class="mr1 round button-hollow button-hollow-large {{playing ? 'button-enabled' : ''}}" ng-click="toggle();">►</button>
    <span class="inline-block">
      <span class="control">
        <label class="control-label" style="text-align: right;">Tempo&nbsp;&nbsp;</label>
        <span class="annotated-input">
          <input ng-model="tempo" ng-change="updateTempo();" type="range" min="30" max="255" />
          <span>{{tempo}}</span>
        </span>
      </span>
      <span class="control">
        <label class="control-label" style="text-align: right;">Volume&nbsp;&nbsp;</label>
        <span class="annotated-input">
          <input ng-model="amplitude" ng-change="updateAmplitude();" type="range" min="0.0" max="1.0" step="0.01" />
          <span>{{(amplitude * 100) | number:0}}%</span>
        </span>
      </span>
    </span>
  </div>
  <div id="download-container">
    <div>
      <button class="button-full button-hollow right" ng-click="export();"><span class="h3" style="line-height: 1.0rem;">&darr;</span>&nbsp; *.wav</button>
      <a id="hidden-download-link" class="display-none" download="output.wav" href=""></a>
    </div>
    <span class="control mt2 display-none">
      <label class="control-label">File Name:</label>
      <span class="annotated-input">
        <input ng-model="downloadFileName" class="underlinedInput" type="text" />
        <span>.wav</span>
      </span>
    </span>
  </div>
</div>

<div ng-controller="SequencerController" class="pt2" style="border-top: 2px solid #ddd;">
  <h2 class="mt0 mb1">Sequencer</h2>
  <div class="flex">
    <ul class="flex flex-column mt0 ml0 pl0 border-box" ng-class="{expanded: (expanded === true), contracted: (expanded === false)}">
      <li class="list-style-none border-box bb"><span><button class="button-small button-hollow pt0 pb0" style="border-radius: 6px; width: 40px;" ng-click="toggleExpansion();">{{expansionToggleLabel}}</button></span></li>
      <li class="flex-uniform-size list-style-none pr1 bb br" ng-repeat="track in tracks">
        <input class="underlinedInput full-width" ng-model="track.name" ng-change="changeTrackName(track.id);" type="text" />
        <button class="button-hollow button-small {{track.muted ? 'button-enabled' : ''}}" ng-click="toggleTrackMute(track.id);">Mute</button>
        <button class="button-hollow button-small {{track.id === selectedTrack.id ? 'button-enabled' : ''}}" ng-click="changeSelectedTrack(track.id);">Edit</button>
      </li>
    </ul>
    <ul class="flex flex-uniform-size flex-column mt0 ml0 pl0 overflow-scroll-x border-box">
      <li class="inline-block list-style-none full-width">
        <ul class="flex ml0 pl0 no-whitespace-wrap">
          <li class="flex-uniform-size list-style-none border-box bb" style="min-width: 150px;" ng-model="currentStep" ng-repeat="n in [1,2,3,4,5,6,7,8,]">
            <span class="inline-block center full-width" ng-class="{enabled: currentStep === n}">{{n}}</span>
          </li>
        </ul>
      </li>
      <li ng-repeat="track in tracks" class="list-style-none full-width" style="height: 6.0rem;">
        <ul class="flex ml0 pl0 no-whitespace-wrap" style="height: 100%;">
          <li class="flex-uniform-size list-style-none center border-box bb br" style="min-width: 150px; height: 100%;" ng-repeat="pattern in track.patterns" ng-init="sequencerIndex = $index" ng-class="{enabledlight: currentStep === ($index + 1)}">
            <span class="flex flex-align-center pl1 pr1 border-box" style="height: 100%;">
              <select class="full-width" ng-model="pattern.patternID" ng-change="changeSequencer(sequencerIndex);" convert-to-number>
                <option ng-repeat="patternOption in patternOptions[$parent.$index]" value="{{patternOption.id}}">{{patternOption.name}}</option>
              </select>
            </span>
          </li>
        </ul>
      </li>
    </ul>
    <ul class="flex flex-column mt0 ml0 pl0 border-box" ng-class="{'display-none': (expanded === false)}">
      <li class="list-style-none inline-block border-box bb"><span>&nbsp;</span></li>
      <li class="flex flex-align-center flex-uniform-size list-style-none bb bl" style="padding-left: 1.0rem;" ng-repeat="track in tracks">
        <button class="button-small button-hollow full-width round" ng-click="removeTrack(track.id);">X</button>
      </li>
    </ul>
  </div>
  <div class="overflow-auto">
    <button class="block button-full button-hollow" ng-click="addTrack();">Add Track</button>
  </div>
</div>

<div ng-controller="TrackEditorController" class="mt2" style="border-top: 2px solid #ddd; border-bottom: 2px solid #ddd;">
  <div tab-list title="{{trackName}}" class="mt1">
    <div tab-pane title="Instrument">
      <div ng-controller="InstrumentController">
        <div instrument-editor instrument="instrument" class="flex overflow-scroll-x pb1" update-instrument="updateInstrument()"></div>
      </div>
    </div>
    <div tab-pane title="Patterns" class="mt1">
      <div ng-controller="PatternCollectionController" class="mb2">
        <ul class="flex flex-uniform-size pl0 mt0 mb0 overflow-scroll-x">
          <li class="list-style-none pointer border-box mr1" ng-repeat="patternOption in patternOptions" ng-click="changeSelectedPattern(patternOption.id);"  ng-class="{paneTabSelected: (patternOption.id === selectedPatternID), paneTabUnselected: (patternOption.id !== selectedPatternID)}">
            <span>{{patternOption.name}}</span><button class="button-small button-hollow round ml1" style="padding: 0;" ng-click="removePattern(patternOption.id);" ng-class="{'display-none': (patternOptions.length <= 1)}">&nbsp;X&nbsp;</button>
          </li>
        </ul>
        <button class="block button-full button-hollow mt1" ng-click="addPattern();">Add Pattern</button>
      </div>

      <div ng-controller="PatternController">
        <div>
          <label>Name:</label><input class="underlinedInput" ng-model="pattern.name" ng-change="updateName();" type="text" /> <span class="h4"> - <a class="helperToggle underline" ng-click="show=!show">Tips and Tricks</a></span>
          <ul class="toggleable" ng-show="show">
            <li>A note is a letter between A and G plus an octave between 0 and 7. For example: <b>A3</b>, <b>C♯4</b>, <b>E♭2</b></li>
            <li>Use &lsquo;#&rsquo; to enter a sharp, and a lowercase &lsquo;b&rsquo; to enter a flat</li>
            <li>Use &mdash; to lengthen a note. For example, &lsquo;A4&mdash;&mdash;&mdash;&rsquo; will last for 4 steps, while &lsquo;A4&mdash;&rsquo; will last for two, and &lsquo;A4&rsquo; will last for one.</li>
            <li>Press <code>SPACE</code> to clear the current note</li>
            <li>Use the left/right arrow keys to move between notes, and the up/down arrow keys to move between tracks</li>
          </ul>
          <div class="flex">
            <ul class="flex flex-column mt0 ml0 pl0 overflow-scroll-x border-box">
              <li class="flex-uniform-size list-style-none inline-block note-container"><span class="h4 note-column-header">&nbsp;</span></li>
              <li class="flex-uniform-size list-style-none" ng-repeat="track in pattern.tracks">
                <button class="button-small button-hollow {{pattern.tracks[$index].muted ? 'button-enabled' : ''}}" ng-click="toggleTrackMute($index);">Mute</button>
              </li>
            </ul>
            <ul class="flex flex-column flex-uniform-size mt0 ml0 pl0 overflow-scroll-x border-box">
              <li class="inline-block list-style-none full-width">
                <ul class="ml0 pl0 center no-whitespace-wrap">
                  <li class="list-style-none inline-block note-container" ng-repeat="n in [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]">
                    <span class="h4 note-column-header">{{n}}</span>
                  </li>
                </ul>
              </li>
              <li ng-repeat="track in pattern.tracks" class="inline-block list-style-none full-width">
                <ul class="ml0 pl0 no-whitespace-wrap">
                  <li class="list-style-none inline-block note-container" ng-repeat="note in track.notes">
                    <input note-input id="pattern-{{pattern.id}}-track-{{$parent.$index}}-note-{{$index}}" class="note" ng-class="{firstTrack: $parent.$first, lastTrack: $parent.$last, firstNote: $first, lastNote: $last}" ng-model="note.name" ng-change="updateNotes($parent.$index, $index);" maxlength="4" type="text" />
                   </li>
                </ul>
              </li>
            </ul>
            <ul class="flex flex-column mt0 ml0 pl0 overflow-scroll-x border-box">
              <li class="list-style-none flex-uniform-size">&nbsp;</li>
              <li class="list-style-none flex-uniform-size" ng-repeat="track in pattern.tracks">
                <button class="button-small button-hollow full-width round" ng-click="removeTrack($index);">X</button>
              </li>
            </ul>
          </div>
          <div class="mb1 overflow-auto">
            <button class="block button-full button-hollow" ng-click="addTrack();">Add Row</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<p class="center mt2 mb2">Made by <a href="http://www.joelstrait.com">Joel Strait</a>, &copy; 2014-16</p>
</body>
</html>
